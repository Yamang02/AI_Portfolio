/* Base */
.imageWrapper {
  position: relative;
  overflow: visible;
  width: 100%;
  min-height: 500px;
  border-radius: 16px;
}

.image,
.highlightImage {
  position: absolute;
  width: 420px;
  height: 236px;
  object-fit: contain;
  border-radius: 16px;
  transition: opacity 0.6s ease-in-out, transform 0.6s ease-in-out;
}

.image {
  z-index: 1;
  opacity: 1;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

.highlightImage {
  z-index: 2;
  opacity: 0;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

/* Animations (지원되는 브라우저) */
@supports (animation-timeline: view()) {
  .image {
    animation: imageMoveAndFade ease-in-out;
    animation-timeline: view();
    animation-range: entry 0% exit 40%;
    animation-fill-mode: both;
  }

  .highlightImage {
    animation: highlightImageMoveAndFade ease-in-out;
    animation-timeline: view();
    animation-range: entry 30% exit 100%;
    animation-fill-mode: both;
  }

  @keyframes imageMoveAndFade {
    0% {
      opacity: 1;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    50% {
      opacity: 0.2;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    100% {
      opacity: 0.2;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
  }

  @keyframes highlightImageMoveAndFade {
    0% {
      opacity: 0;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    25% {
      opacity: 1;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    100% {
      opacity: 1;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
  }
}

/* Fallback (미지원 브라우저) */
@supports not (animation-timeline: view()) {
  .image {
    opacity: 1;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .highlightImage {
    opacity: 0;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }
}

/* 반응형 */
@media (max-width: 768px) {
  .imageWrapper {
    order: -1;
    min-height: 400px;
  }

  .image,
  .highlightImage {
    width: 100%;
    max-width: 350px;
    height: auto;
    aspect-ratio: 420 / 236;
  }

  /* 모바일에서는 중앙 정렬로 단순화 */
  @supports (animation-timeline: view()) {
    .image {
      animation: imageFadeOutMobile ease-in-out;
      animation-timeline: view();
      animation-range: entry 0% exit 40%;
      animation-fill-mode: both;
    }

    .highlightImage {
      animation: highlightImageFadeInMobile ease-in-out;
      animation-timeline: view();
      animation-range: entry 40% exit 100%;
      animation-fill-mode: both;
    }

    @keyframes imageFadeOutMobile {
      0%, 30% {
        opacity: 1;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
      100% {
        opacity: 0.2;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
    }

    @keyframes highlightImageFadeInMobile {
      0% {
        opacity: 0;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
      25%, 100% {
        opacity: 1;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
    }
  }

  @supports not (animation-timeline: view()) {
    .image {
      opacity: 0.2;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .highlightImage {
      opacity: 1;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
  }
}

/* 접근성: 애니메이션 비활성화 */
/* prefers-reduced-motion은 가장 마지막에 배치하여 우선순위 확보 */
@media (prefers-reduced-motion: reduce) {
  @supports (animation-timeline: view()) {
    .image {
      animation: none;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 0.2;
    }

    .highlightImage {
      animation: none;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 1;
    }
  }

  @supports not (animation-timeline: view()) {
    .image {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 0.2;
    }

    .highlightImage {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      opacity: 1;
    }
  }

  .image,
  .highlightImage {
    transition: none;
  }

  /* 모바일 접근성 */
  @media (max-width: 768px) {
    .image,
    .highlightImage {
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
  }
}
